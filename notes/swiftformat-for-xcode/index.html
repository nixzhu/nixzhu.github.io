<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="NIX ZHU"/><link rel="canonical" href="https://nixzhu.dev/notes/swiftformat-for-xcode"/><meta name="twitter:url" content="https://nixzhu.dev/notes/swiftformat-for-xcode"/><meta name="og:url" content="https://nixzhu.dev/notes/swiftformat-for-xcode"/><title>通过快捷键在 Xcode 中使用 SwiftFormat | NIX ZHU</title><meta name="twitter:title" content="通过快捷键在 Xcode 中使用 SwiftFormat | NIX ZHU"/><meta name="og:title" content="通过快捷键在 Xcode 中使用 SwiftFormat | NIX ZHU"/><meta name="description" content="SwiftFormat 有一个 Xcode Source Editor Extension，在我们定义好快捷键的情况下，在 Xcode 内使用的体验很不错"/><meta name="twitter:description" content="SwiftFormat 有一个 Xcode Source Editor Extension，在我们定义好快捷键的情况下，在 Xcode 内使用的体验很不错"/><meta name="og:description" content="SwiftFormat 有一个 Xcode Source Editor Extension，在我们定义好快捷键的情况下，在 Xcode 内使用的体验很不错"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to NIX ZHU"/></head><body class="item-page"><header><div class="wrapper"><a href="/" class="site-name">NIX ZHU</a><nav><ul><li><a href="/posts">Posts</a></li><li><a href="/notes" class="selected">Notes</a></li><li><a href="/apps">Apps</a></li><li><a href="/about">About</a></li></ul></nav></div></header><div class="wrapper"><article><div class="date">2021/10/19</div><div class="content"><h1>通过快捷键在 Xcode 中使用 SwiftFormat</h1><h2>安装</h2><p>步骤如下：</p><ol><li>安装 <strong>SwiftFormat for Xcode.app</strong>。可直接去其 GitHub 仓库<a href="https://github.com/nicklockwood/SwiftFormat/releases">下载安装</a>。如果你使用 Homebrew，也可<a href="https://github.com/nicklockwood/SwiftFormat#xcode-source-editor-extension">参考其介绍以安装</a>。装好后记得打开一下此应用，确保有权限使用</li><li>安装此 app 提供的 Xcode Source Editor Extension：<ol><li>点击状态栏左上角的 ，打开<strong>系统偏好设置</strong>，选择<strong>扩展</strong></li><li>找到并选中 <strong>Xcode Source Editor</strong>，然后右边勾选 <strong>SwiftFormat</strong></li><li>重新启动一下 Xcode，然后检查 Xcode 的 Editor 菜单底部，应该会出现 <strong>SwiftFormat</strong> 菜单</li><li>设置针对当前文件的快捷键：</li><li>从 Xcode 的菜单打开 <strong>Preferences...</strong>，选中 <strong>Key Bindings</strong></li><li>在右上的 Filter 里输入 <strong>swiftformat</strong>，然后选中第二个 <strong>SwiftFormat &gt; Format File</strong></li><li>双击高亮行对应 Key 的位置，然后同时按下键盘上的 <strong>Shift</strong> + <strong>Ctrl</strong> + <strong>I</strong>（如果你喜欢其它快捷键可自行选择）</li></ol></li></ol><p>经过上述步骤，我们就给 Xcode 安装好了 SwiftFormat 的 Source Editor Extension，而且可以用快捷键触发。现在你可以在 Xcode 里随意选中一个 Swift 文件，然后按下快捷键 <strong>Shift</strong> + <strong>Ctrl</strong> + <strong>I</strong>，SwiftFormat 就会根据它当前的规则对这个被选中的 Swift 文件进行代码风格的格式化。如果你的代码经过 Git 管理，应该能看到格式化前后的差异，比如一些空行、逗号、缩进之类</p><p>在实践上，比如你在做某个功能，修改了某些 Swift 文件，那就在改动这些文件后，按下快捷键 <strong>Shift</strong> + <strong>Ctrl</strong> + <strong>I</strong> 来格式化代码（必要时再手动做一些微调）。以此，可以循序渐进地改善整体代码的风格</p><h2>配置</h2><p>刚才提到<strong>规则</strong>，你可以打开 <strong>SwiftFormat for Xcode.app</strong> ，选中第二个 <strong>Rules</strong> Tab 进行调整</p><p>取消勾选 <strong>Infer Options Automatically</strong>，这样的话我们可以搜索并<strong>调整</strong>一些选项的参数，例如：</p><ul><li>勾选 <strong>acronyms</strong>，保持 <strong>Acronyms</strong> 其值为 <strong>ID,URL,UUID,VC</strong>，这样一些属性命名中的缩略词会被自动“纠正”，以符合 <a href="https://github.com/SketchK/the-swift-api-design-guidelines-in-chinese/blob/master/README.md">Swift 的 API 设计指南</a></li></ul><ul><li>勾选 <strong>blankLinesBetweenImports</strong>，会移除 import 语句之间的空行</li></ul><ul><li>勾选 <strong>blockComments</strong>，自动将注释换成 <strong>//</strong> 或 <strong>///</strong> 风格</li></ul><ul><li><strong>extensionAccessControl</strong>。将其 <strong>Extension Access Control Level Placement</strong> 改为 <strong>on-declarations</strong>，以将访问控制定义在具体的属性或方法上</li></ul><ul><li><strong>fileHeader</strong>。将其 <strong>Header</strong> 改为 <strong>strip</strong>，以去除头部的文件注释</li></ul><ul><li><strong>hoistPatternLet</strong>。将其 <strong>Pattern Let</strong> 改为 <strong>inline</strong>，以符合 <a href="https://pages.swift.gg/google-swift-style-guide-in-chinese/">Google 的规范</a></li></ul><ul><li><strong>indent</strong>。将其 <strong>Ifdef Indent</strong> 改为 <strong>no-indent</strong>；<strong>Indent Strings</strong> 改为 <strong>true</strong></li></ul><ul><li><strong>modifierOrder</strong>。将其 <strong>Modifier Oder</strong> 改为 <strong>final,open,public,fileprivate,private,private(set),override,convenience,lazy,static,weak</strong>，如果你不喜欢这个顺序可自行调整</li></ul><ul><li><strong>spaceAroundOperators</strong>。将其 <strong>Ranges</strong> 改为 <strong>no-space</strong>，这样 <strong>...</strong> 和 <strong>..&lt;</strong> 操作符前后的空格会被去除</li></ul><ul><li><strong>unusedArguments</strong>。将其 <strong>Strip Unused Arguments</strong> 改为 <strong>closure-only</strong>，防止一些方法的实参被替换为下划线</li></ul><ul><li><strong>wrap</strong>。将其 <strong>Max Width</strong> 改为 <strong>100</strong>，这样太长的代码会被折行</li></ul><ul><li>针对 <strong>wrapArguments</strong>，将其<ul><li><strong>Wrap Arguments</strong> 改为 <strong>before-first</strong></li><li><strong>Wrap Collections</strong> 改为 <strong>before-first</strong></li><li><strong>Wrap Conditions</strong> 改为 <strong>preserve</strong></li><li><strong>Wrap Parameters</strong> 改为 <strong>before-first</strong></li><li><strong>Wrap Return Type</strong> 改为 <strong>preserve</strong></li><li><strong>Wrap Typealiases</strong> 改为 <strong>preserve</strong></li></ul></li></ul><p><strong>Swift version</strong> 选择 <strong>5.5</strong>（目前版本 0.49.8 所支持的最高 Swift 版本）。</p><p>可搜索并<strong>关闭</strong>如下规则：</p><ul><li><strong>markTypes</strong>。开启的话，会强制你写一些 <strong>// MARK:</strong> 标记</li><li><strong>organizeDeclarations</strong>。开启的话，会按照更细致的规则对各种声明进行排序，可能不是你所希望的</li><li><strong>sortedImports</strong>。开启的话，会将 import 的语句按照字母表排序</li><li><strong>sortedSwitchCases</strong>。开启的话，会将 switch 的 case 语句按照字母表排序</li><li><strong>wrapSwitchCases</strong>。开启的话，会强制 switch 时每个 case 单独一行</li></ul><p>可进一步参考详细的<a href="https://github.com/nicklockwood/SwiftFormat/blob/master/Rules.md">规则文档</a></p><h2>小技巧</h2><p>如果你想将有多个参数的函数的参数进行折行，只需先将其尾部的括号换行（可在输入最后一个参数后进行），然后按下快捷键（比一个个手动换行要快不少）</p></div><ul class="tag-list"><li><a href="/tags/xcode">Xcode</a></li><li><a href="/tags/swiftformat">SwiftFormat</a></li><li><a href="/tags/swiftformat-for-xcode">SwiftFormat for Xcode</a></li></ul></article></div><footer><p>Copyright © nixzhu. All rights reserved.</p><p><a href="/feed.rss">RSS feed</a></p></footer></body></html>